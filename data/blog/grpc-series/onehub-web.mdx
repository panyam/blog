---
title: 'Part 8 - OneHub Web Interface'
date: 2023-06-06T11:29:10Z
lastmod: '2022-06-08'
tags: ['react', 'gin-gonic', 'web', 'frontend']
draft: false
authors: ['Sri Panyam']
layout: PostSimple
summary: A frontend/UI is a very important feature of an application accessible by users.   In this post we will show a simple frontend and evolve our service and setup to incorporate this new component going forward
---

## Introduction

For OneHub (our canonical demo chat service) we have [so far](/blog/grpc-series/index) built:

* A gRPC service/api for managing Topics and sending/receiving Messages
* Restful bindings for http access
* A CLI (in Cobra) for access via the terminal/command line

For a chat application a UI is a no-brainer.  We will build a (super simple) Web UI using NextJS.   The goal of this post is **NOT** to provide a cool UI or a deep tutorial on front end technologies - which is a technically very complex area.  Instead the goal of this post is to:

* Bring up a very simple web UI with standard frameworks/libraries
* We will use NextJS for this.  NextJS was chosen because not being a front-end expert, ease of onboarding, community support and documentation/examples were key.
* Package the frontend as its own service in our docker-compose setup.  Our key requirement is ease of use and agility - live reloading will be key.
* Support development and production mode so that when we ready we can serve published artifacts as a static site as much as possible.
* Demonstrate changes to our "web" layer needed to support a front-end.

## Setup a NextJS Frontend

We have built a very simple frontend webapp using NextJS and TypeScript.   We wont be diving into a tutorial on NextJS.  The [NextJS documentation](https://nextjs.org/docs) is quite brilliant as are the [several](https://nextjs.org/learn/basics/create-nextjs-app) [other](https://www.freecodecamp.org/news/build-a-full-stack-application-with-nextjs/) [brilliant](https://stackdiary.com/next-js-tutorial-getting-started/) [sources](https://www.tuthub.io/resources/topics/NextJS%20for%20beginners).

To start our very basic frontend, from the `frontend` subfolder:

```
npm install
npm run dev
```

Pointing your browser to open [this](http://localhost:3000) should show a basic UI.

## Architecture Choices

Below is our current architecture:

<center>
<img src="/static/images/current-architecture.svg" width={800} />
</center>

* Currently the TopicService, MessageService and the gRPC Gateway all run as separate processes within the same process (exposed in [cmd/server.go](https://github.com/panyam/onehub/blob/PART8_WEBUI/cmd/server.go)).
* The grpc-gateway process accepts API requests (over http) and routes these to appropriate services (topics or messages).

What we want is a new frontend (FE) service that only serves front end - either staticaly or as Server Side Rendered pages.  And this FE service would make API calls to CRUD Topics, Messages and other entities.  So our proposed architecture would look something like:

<center>
<img src="/static/images/proposed-architecture.svg" width={800} />
</center>


In this proposed architecture we have:

* Our current grpc-gateway service running as before forwarding API requests to the gRPC services
* We are adding a new (dedicated) frontend service that is responsible for rendering all pages/screens/views of our application as well as turning UI events (from the user) into updates on the various entities.  The frontend service in our case is a simple NextJS based app.
* We are also adding a new entity - the Router - that routes http requests to either the Frontend service or our grpc gateway based on whether the request is a API request or a view/page request.

